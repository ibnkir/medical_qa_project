## Мастерская Yandex Практикума: Проект "Medical QA"

### Описание проекта:
Исходные данные:
[Набор пар медицинских вопросов](https://huggingface.co/datasets/medical_questions_pairs) с метками `1` и `0` (вопросы похожи / непохожи).

Цель: Разработать рекомендательный сервис для поиска заданного количества медицинских вопросов, похожих на введенный пользователем текст.

Результаты:
* Проверили исходный датасет на наличие пропусков, дублирующих пар вопросов и сбалансированность меток;
* Создали корпус вопросов и добавили их id в исходный датасет;
* Применили несколько способов предобработки и векторизации текста вопросов, наибольшая точность поиска `accuracy@n` получилась у языковой модели BERT,
  предобученной на определении схожести текстов (SentenceTransformer);
* Добавили классификатор, чтобы из вопросов, ближайших к заданному с точки зрения векторного расстояния, отбирать в первую очередь те,
  для которых этот классификатор выдает `1`. Классификатор был обучен на расширенном корпусе вопросов, в котором к исходным парам вопросов добавлены те же пары,
  но с вопросами, взятыми в другом порядке. При этом в пользовательском интерейсе предусмотрена возможность отключения данного классификатора для ускорения работы сервиса;
* Создали микросервис и клиентскую часть на базе FastAPI и Streamlit соответственно.

Выполнил:
Кирилл Н., email: ibnkir@yandex.ru, tg: [Xmg23](https://t.me/Xmg23).

### Структура репозитория:
* data - обучающие данные (при первом использовании данные скачиваются с HuggingFace, предобрабатываются и сохраняются локально);
* models - обученные сериализованные модели;
* notebooks - тетрадки Jupyter Notebooks для EDA, прототипирования решения и обучения модели классификатора;
* app - код FastAPI и Streamlit приложений.

### Как воспользоваться репозиторием:
* Убедитесь, что на вашем компьютере установлен Python и все необходимые пакеты (см. файл requirements.txt).
* Развертывание репозитория без докера
   1. Склонировать репозиторий на ваш компьютер
      ```bash
      git clone https://github.com/ibnkir/medical_qa_project.git
      ```
   2. Перейти в подпапку `app` проекта
      ```bash
      cd ./medical_qa_project/app
       ```
   3. Запустить серверную часть (если порт 8081 уже занят, то заменить его на другой)
      ```bash
      uvicorn fastapi_app:app --reload --port 8081 --host 0.0.0.0
      ```
   4. Запустить клиентскую часть
      ```bash
      streamlit run streamlit_app.py
      ```
* Развертывание репозитория в докере:
