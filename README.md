## Мастерская Yandex Практикума: Проект "Medical QA"

### Описание проекта:
Исходные данные:
[Набор пар медицинских вопросов](https://huggingface.co/datasets/medical_questions_pairs) с метками `1` и `0` (вопросы похожи / непохожи).

Цель: Разработать рекомендательный сервис для поиска медицинских вопросов, похожих на введенный пользователем текст.

Результаты:
* Проверили исходный датасет на отсутствие пропусков, дублирующих пар вопросов и сбалансированность меток;
* Создали корпус вопросов и добавили их id в исходный датасет;
* Применили несколько способов предобработки и векторизации текста, наибольшая точность поиска `accuracy@n` получилась у языковой модели BERT,
  предобученной на определении схожести текстов (SentenceTransformer);
* Добавили классификатор, чтобы из вопросов, ближайших к заданному с точки зрения векторного расстояния, отбирать в первую очередь те, для которых классификатор выдает 1. Обучение проводилось на расширенном датасете, в котором к исходным парам вопросов были добавлены пары с вопросами в обратном порядке. В качестве классификатора были использованы CatBoostClassifier и дообученный BERT. Наибольшую точность классификации на тестовой выборке показал 2-й вариант, поэтому выбрали его и заново обучили на всем датасете. Кроме того, в пользовательском интерфейсе добавили возможность отключения классификатора для ускорения работы;
* Создали микросервис и клиентскую часть на базе FastAPI и Streamlit соответственно.
  
Выполнил:
Кирилл Н., email: ibnkir@yandex.ru, tg: [Xmg23](https://t.me/Xmg23).

### Структура репозитория:
* data - локально сохраненные данные;
* models - обученные сериализованные модели классификатора;
* notebooks - тетрадки Jupyter Notebooks для EDA, прототипирования решения и обучения модели классификатора;
* app - код FastAPI и Streamlit приложений.

### Как воспользоваться репозиторием:
0. Убедитесь, что на вашем компьютере установлен Python и все необходимые пакеты (см. файл requirements.txt).
1. Перейти в домашнюю папку и склонировать репозиторий на ваш компьютер
   ```bash
   cd ~
   git clone https://github.com/ibnkir/medical_qa_project.git
   ```
2. Открыть ноутбук `medical_qa_project/notebooks/prototyping.ipynb` в Jupyter Notebook и выполнить все ячейки в 9-м разделе для обучения модели классификатора
   (либо можно это не делать, тогда при отправке запроса в пользовательском веб-интерфейсе должен быть снят флажок, отвечающий за использование классификатора)
4. Перейти в подпапку `app` проекта
   ```bash
   cd medical_qa_project/app
   ```
5. Запустить серверную часть (если порт 8081 уже занят, то заменить его на другой)
   ```bash
   uvicorn fastapi_app:app --reload --port 8081 --host 0.0.0.0
   ```
6. Запустить клиентскую часть
   ```bash
   streamlit run streamlit_app.py
   ```
